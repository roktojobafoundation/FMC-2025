<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard | Roktojoba Foundation</title>

    <!-- Favicon Links -->
    <link rel="icon" href="assets/favicon.webp" type="image/webp">
    <link rel="icon" href="assets/favicon.webp" sizes="16x16" type="image/webp">
    <link rel="icon" href="assets/favicon.webp" sizes="32x32" type="image/webp">
    <link rel="apple-touch-icon" href="assets/favicon.webp">

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <!-- CSS Files -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/admin.css">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@300;400;500&display=swap"
        rel="stylesheet">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<!-- admin-dashboard.html এর head section এর পরে -->
<script>
    // Immediate auth check before page loads
    (function () {
        // Wait for page to load completely
        setTimeout(function () {
            // Check localStorage first (primary check)
            const adminAuth = localStorage.getItem('adminAuth');
            const sessionAuth = sessionStorage.getItem('currentAdmin');

            console.log('Auth check - localStorage adminAuth:', adminAuth);
            console.log('Auth check - sessionStorage currentAdmin:', sessionAuth);

            // If no auth found, check if we're on login page
            const isLoginPage = window.location.pathname.includes('admin-login.html');

            if (!adminAuth && !sessionAuth) {
                console.log('No auth found, checking Firebase...');

                // Check Firebase auth after a delay
                setTimeout(() => {
                    if (typeof auth !== 'undefined') {
                        console.log('Firebase auth available, checking current user...');
                        if (!auth.currentUser && !isLoginPage) {
                            console.log('No Firebase user, redirecting to login');
                            window.location.href = 'admin-login.html';
                        }
                    } else {
                        console.log('Firebase not initialized, but no local auth found');
                        if (!isLoginPage) {
                            window.location.href = 'admin-login.html';
                        }
                    }
                }, 1000);
            } else {
                console.log('Auth found in storage, proceeding...');
            }
        }, 500);
    })();
</script>
<script>
    // Immediate auth check with proper display name handling
    (function () {
        document.addEventListener('DOMContentLoaded', function () {
            // Check localStorage for auth data
            const adminAuth = localStorage.getItem('adminAuth');

            if (adminAuth) {
                try {
                    const authData = JSON.parse(adminAuth);

                    // Ensure display name is set correctly
                    if (authData.email === 'admintasrik@rjfmedical.com' &&
                        (!authData.displayName || !authData.displayName.includes('Tasrik'))) {
                        authData.displayName = 'Tasrik Hossain "Admin & Founder"';
                        localStorage.setItem('adminAuth', JSON.stringify(authData));
                    }
                    else if (authData.email === 'admin@rjfmedical.com' &&
                        (!authData.displayName || !authData.displayName.includes('FMC'))) {
                        authData.displayName = 'FMC "Admin"';
                        localStorage.setItem('adminAuth', JSON.stringify(authData));
                    }

                    // Update UI immediately
                    updateUserInfoFromStorage();

                } catch (error) {
                    console.error('Error processing auth data:', error);
                }
            }
        });

        // Helper function to update user info
        function updateUserInfoFromStorage() {
            const localAuth = localStorage.getItem('adminAuth');
            if (localAuth) {
                try {
                    const authData = JSON.parse(localAuth);
                    const userAvatar = document.getElementById('userAvatar');
                    const userName = document.getElementById('userName');
                    const userEmail = document.getElementById('userEmail');

                    if (userAvatar) {
                        const initials = (authData.displayName || authData.email).substring(0, 2).toUpperCase();
                        userAvatar.textContent = initials;
                    }

                    if (userName) {
                        // Use stored displayName or fallback to email mapping
                        let displayName = authData.displayName;
                        if (!displayName || displayName === '') {
                            if (authData.email === 'admintasrik@rjfmedical.com') {
                                displayName = 'Tasrik Hossain "Admin & Founder"';
                            } else if (authData.email === 'admin@rjfmedical.com') {
                                displayName = 'FMC "Admin"';
                            } else {
                                displayName = authData.email.split('@')[0];
                            }
                        }
                        userName.textContent = displayName;
                    }

                    if (userEmail) {
                        userEmail.textContent = authData.email;
                    }
                } catch (error) {
                    console.error('Error parsing auth data:', error);
                }
            }
        }
    })();
</script>

<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="admin-sidebar">
            <div class="sidebar-header">
                <h3><i class="fas fa-user-shield"></i></i> Admin Portal</h3>
                <button class="sidebar-toggle">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </div>

            <ul class="sidebar-nav">
                <li>
                    <a href="#" class="nav-link active" id="dashboardLink">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link" id="patientsLink">
                        <i class="fas fa-user-injured"></i>
                        <span>Patients</span>
                        <span class="badge" id="patientBadge">0</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link" id="doctorsLink">
                        <i class="fas fa-user-md"></i>
                        <span>Doctors</span>
                        <span class="badge" id="doctorBadge">0</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link" id="volunteersLink">
                        <i class="fas fa-hands-helping"></i>
                        <span>Volunteers</span>
                        <span class="badge" id="volunteerBadge">0</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link" id="reportsLink">
                        <i class="fas fa-chart-pie"></i>
                        <span>Reports</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link" id="settingsLink">
                        <i class="fas fa-cogs"></i>
                        <span>Settings</span>
                    </a>
                </li>
            </ul>

            <div class="logout-btn">
                <button class="btn btn-outline btn-block" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <!-- Header -->
            <header class="admin-header">
                <button class="mobile-menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>

                <div class="header-title">
                    <h2>Admin Dashboard</h2>
                    <p>16 December 2025 - Roktojoba Foundation Free Medical Camp Management</p>
                </div>

                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">A</div>
                    <div>
                        <div class="user-name" id="userName">Admin User</div>
                        <div class="user-email" id="userEmail">admin@roktojoba.org</div>
                    </div>
                </div>
            </header>

            <!-- Alert Container -->
            <div id="alertContainer" style="padding: 20px 30px 0;"></div>

            <!-- Main Content Area -->
            <div class="admin-content">
                <!-- Dashboard Section -->
                <section id="dashboardSection" class="dashboard-section">
                    <div class="section-header">
                        <h3><i class="fas fa-tachometer-alt"></i> Overview</h3>
                        <div class="last-updated" id="lastUpdated">
                            Last updated: <span id="updateTime">Loading...</span>
                        </div>
                    </div>

                    <!-- Stats Cards -->
                    <div class="dashboard-stats">
                        <div class="stat-card-admin">
                            <div class="stat-icon-admin">
                                <i class="fas fa-user-injured"></i>
                            </div>
                            <div class="stat-content-admin">
                                <h3 id="totalPatientsCount">0</h3>
                                <p>Total Patients</p>
                            </div>
                        </div>

                        <div class="stat-card-admin">
                            <div class="stat-icon-admin">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-content-admin">
                                <h3 id="waitingPatientsCount">0</h3>
                                <p>Waiting Patients</p>
                            </div>
                        </div>

                        <div class="stat-card-admin">
                            <div class="stat-icon-admin">
                                <i class="fas fa-user-md"></i>
                            </div>
                            <div class="stat-content-admin">
                                <h3 id="ongoingPatientsCount">0</h3>
                                <p>Under Checkup</p>
                            </div>
                        </div>

                        <div class="stat-card-admin">
                            <div class="stat-icon-admin">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-content-admin">
                                <h3 id="completedPatientsCount">0</h3>
                                <p>Completed</p>
                            </div>
                        </div>

                        <div class="stat-card-admin">
                            <div class="stat-icon-admin">
                                <i class="fas fa-stethoscope"></i>
                            </div>
                            <div class="stat-content-admin">
                                <h3 id="totalDoctorsCount">0</h3>
                                <p>Active Doctors</p>
                            </div>
                        </div>

                        <div class="stat-card-admin">
                            <div class="stat-icon-admin">
                                <i class="fas fa-hands-helping"></i>
                            </div>
                            <div class="stat-content-admin">
                                <h3 id="totalVolunteersCount">0</h3>
                                <p>Volunteers</p>
                            </div>
                        </div>

                        <div class="stat-card-admin">
                            <div class="stat-icon-admin">
                                <i class="fas fa-hourglass-half"></i>
                            </div>
                            <div class="stat-content-admin">
                                <h3 id="avgWaitTime">0 min</h3>
                                <p>Avg. Wait Time</p>
                            </div>
                        </div>

                        <div class="stat-card-admin">
                            <div class="stat-icon-admin">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-content-admin">
                                <h3 id="completionRate">0%</h3>
                                <p>Completion Rate</p>
                            </div>
                        </div>
                    </div>

                    <!-- Charts -->
                    <div class="charts-grid">
                        <div class="chart-container">
                            <div class="chart-header">
                                <h3>Patient Status Distribution</h3>
                            </div>
                            <canvas id="patientStatusChart"></canvas>
                        </div>

                        <div class="chart-container">
                            <div class="chart-header">
                                <h3>Daily Registrations</h3>
                            </div>
                            <canvas id="dailyRegistrationChart"></canvas>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="table-container">
                        <div class="table-title">
                            <h3><i class="fas fa-history"></i> Recent Activity</h3>
                            <button class="btn btn-sm btn-primary" id="refreshActivity">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>

                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>Activity</th>
                                        <th>User</th>
                                        <th>Details</th>
                                    </tr>
                                </thead>
                                <tbody id="activityTableBody">
                                    <tr>
                                        <td colspan="4" class="text-center">Loading activities...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Patients Section -->
                <section id="patientsSection" class="dashboard-section" style="display: none;">
                    <div class="section-header">
                        <h3><i class="fas fa-user-injured"></i> Patient Management</h3>
                        <div class="header-actions">
                            <button class="btn btn-primary" id="addPatientBtn">
                                <i class="fas fa-user-plus"></i> Add Patient
                            </button>
                            <button class="btn btn-secondary" id="exportPatientsBtn">
                                <i class="fas fa-file-export"></i> Export
                            </button>
                        </div>
                    </div>

                    <!-- Patient Filters -->
                    <div class="filter-controls">
                        <div class="filter-group">
                            <label for="patientSearch">
                                <i class="fas fa-search"></i> Search Patients
                            </label>
                            <input type="text" class="form-control" id="patientSearch"
                                placeholder="Search by ID, name, phone, or email...">
                        </div>

                        <div class="filter-group">
                            <label for="patientStatusFilter">
                                <i class="fas fa-filter"></i> Status
                            </label>
                            <select class="form-control" id="patientStatusFilter">
                                <option value="">All Status</option>
                                <option value="Waiting">Waiting</option>
                                <option value="Under Checkup">Under Checkup</option>
                                <option value="Completed">Completed</option>
                            </select>
                        </div>

                        <div class="filter-group">
                            <label for="patientDoctorFilter">
                                <i class="fas fa-user-md"></i> Doctor
                            </label>
                            <select class="form-control" id="patientDoctorFilter">
                                <option value="">All Doctors</option>
                                <!-- Options will be populated by JavaScript -->
                            </select>
                        </div>

                        <div class="filter-group">
                            <label for="patientSortFilter">
                                <i class="fas fa-sort"></i> Sort By
                            </label>
                            <select class="form-control" id="patientSortFilter">
                                <option value="newest">Newest to Oldest</option>
                                <option value="oldest">Oldest to Newest</option>
                                <option value="name-az">Name (A-Z)</option>
                                <option value="name-za">Name (Z-A)</option>
                                <option value="age-low-high">Age (Low to High)</option>
                                <option value="age-high-low">Age (High to Low)</option>
                            </select>
                        </div>

                        <div class="filter-group">
                            <label>&nbsp;</label>
                            <button class="btn btn-secondary" id="clearFiltersBtn">
                                <i class="fas fa-times"></i> Clear Filters
                            </button>
                        </div>
                    </div>

                    <!-- Patients Table -->
                    <div class="table-container">
                        <div class="table-title">
                            <h3>Registered Patients</h3>
                            <div class="table-actions">
                                <span class="table-count" id="patientCount">0 patients</span>
                            </div>
                        </div>

                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Registration ID</th>
                                        <th>Name</th>
                                        <th>Age</th>
                                        <th>Gender</th>
                                        <th>Phone</th>
                                        <th>Registration Time</th>
                                        <th>Status</th>
                                        <th>Assigned Doctor</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="patientsTableBody">
                                    <tr>
                                        <td colspan="9" class="text-center">Loading patients...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="table-footer">
                            <div class="pagination">
                                <button class="btn btn-sm" id="prevPageBtn" disabled>
                                    <i class="fas fa-chevron-left"></i> Previous
                                </button>
                                <span class="page-info">Page <span id="currentPage">1</span> of <span
                                        id="totalPages">1</span></span>
                                <button class="btn btn-sm" id="nextPageBtn" disabled>
                                    Next <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Doctors Section -->
                <section id="doctorsSection" class="dashboard-section" style="display: none;">
                    <div class="section-header">
                        <h3><i class="fas fa-user-md"></i> Doctor Management</h3>
                        <div class="header-actions">
                            <button class="btn btn-primary" id="addDoctorBtn">
                                <i class="fas fa-user-plus"></i> Add Doctor
                            </button>
                        </div>
                    </div>

                    <!-- Doctor Stats -->
                    <div class="stats-cards-small">
                        <div class="stat-card-small">
                            <div class="stat-icon-small">
                                <i class="fas fa-user-md"></i>
                            </div>
                            <div>
                                <h4 id="totalDoctorsSmall">0</h4>
                                <p>Total Doctors</p>
                            </div>
                        </div>

                        <div class="stat-card-small">
                            <div class="stat-icon-small">
                                <i class="fas fa-user-clock"></i>
                            </div>
                            <div>
                                <h4 id="activeDoctorsSmall">0</h4>
                                <p>Active Today</p>
                            </div>
                        </div>

                        <div class="stat-card-small">
                            <div class="stat-icon-small">
                                <i class="fas fa-users"></i>
                            </div>
                            <div>
                                <h4 id="avgPatientsPerDoctor">0</h4>
                                <p>Avg. Patients/Doctor</p>
                            </div>
                        </div>

                        <div class="stat-card-small">
                            <div class="stat-icon-small">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div>
                                <h4 id="avgCheckupTimeDoctor">0 min</h4>
                                <p>Avg. Checkup Time</p>
                            </div>
                        </div>
                    </div>

                    <!-- Doctors Table -->
                    <div class="table-container">
                        <div class="table-title">
                            <h3>Registered Doctors</h3>
                        </div>

                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Doctor ID</th>
                                        <th>Name</th>
                                        <th>Specialization</th>
                                        <th>Phone</th>
                                        <th>Email</th>
                                        <th>Status</th>
                                        <th>Patients Today</th>
                                        <th>Avg. Time</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="doctorsTableBody">
                                    <tr>
                                        <td colspan="9" class="text-center">Loading doctors...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Volunteers Section -->
                <section id="volunteersSection" class="dashboard-section" style="display: none;">
                    <div class="section-header">
                        <h3><i class="fas fa-hands-helping"></i> Volunteer Management</h3>
                        <div class="header-actions">
                            <button class="btn btn-primary" id="addVolunteerBtn">
                                <i class="fas fa-user-plus"></i> Add Volunteer
                            </button>
                        </div>
                    </div>

                    <!-- Volunteer Stats -->
                    <div class="stats-cards-small">
                        <div class="stat-card-small">
                            <div class="stat-icon-small">
                                <i class="fas fa-hands-helping"></i>
                            </div>
                            <div>
                                <h4 id="totalVolunteersSmall">0</h4>
                                <p>Total Volunteers</p>
                            </div>
                        </div>

                        <div class="stat-card-small">
                            <div class="stat-icon-small">
                                <i class="fas fa-user-check"></i>
                            </div>
                            <div>
                                <h4 id="checkedInVolunteers">0</h4>
                                <p>Checked In</p>
                            </div>
                        </div>

                        <div class="stat-card-small">
                            <div class="stat-icon-small">
                                <i class="fas fa-tasks"></i>
                            </div>
                            <div>
                                <h4 id="assignedVolunteers">0</h4>
                                <p>Tasks Assigned</p>
                            </div>
                        </div>

                        <div class="stat-card-small">
                            <div class="stat-icon-small">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div>
                                <h4 id="avgHoursVolunteer">0 hrs</h4>
                                <p>Avg. Hours</p>
                            </div>
                        </div>
                    </div>

                    <!-- Volunteers Table -->
                    <div class="table-container">
                        <div class="table-title">
                            <h3>Registered Volunteers</h3>
                        </div>

                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Age</th>
                                        <th>Gender</th>
                                        <th>Phone</th>
                                        <th>Preferred Area</th>
                                        <th>Status</th>
                                        <th>Assigned Task</th>
                                        <th>Checked In</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="volunteersTableBody">
                                    <tr>
                                        <td colspan="9" class="text-center">Loading volunteers...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Reports Section -->
                <section id="reportsSection" class="dashboard-section" style="display: none;">
                    <div class="section-header">
                        <h3><i class="fas fa-chart-pie"></i> Reports & Analytics</h3>
                        <div class="header-actions">
                            <button class="btn btn-primary" id="generateReportBtn">
                                <i class="fas fa-file-pdf"></i> Generate Report
                            </button>
                        </div>
                    </div>

                    <!-- Report Filters -->
                    <div class="filters-card">
                        <div class="filter-row">
                            <div class="filter-group">
                                <label>Report Type:</label>
                                <select id="reportType" class="form-control">
                                    <option value="daily">Daily Summary</option>
                                    <option value="patient">Patient Analysis</option>
                                    <option value="doctor">Doctor Performance</option>
                                    <option value="volunteer">Volunteer Report</option>
                                </select>
                            </div>

                            <div class="filter-group">
                                <label>Date Range:</label>
                                <input type="date" id="reportStartDate" class="form-control" value="2025-12-01">
                                <span>to</span>
                                <input type="date" id="reportEndDate" class="form-control" value="2025-12-16">
                            </div>

                            <div class="filter-group">
                                <button class="btn btn-primary" id="generateReport">
                                    <i class="fas fa-chart-bar"></i> Generate
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Report Preview -->
                    <div class="table-container">
                        <div class="table-title">
                            <h3>Report Preview</h3>
                        </div>

                        <div class="report-preview" id="reportPreview">
                            <div class="report-header">
                                <h2>Roktojoba Foundation - Medical Camp Report</h2>
                                <p>December 16, 2025</p>
                            </div>

                            <div class="report-stats" id="reportStats">
                                <!-- Report stats will be loaded here -->
                            </div>

                            <div class="report-charts">
                                <canvas id="reportChart"></canvas>
                            </div>

                            <div class="report-summary" id="reportSummary">
                                <!-- Report summary will be loaded here -->
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Settings Section -->
                <section id="settingsSection" class="dashboard-section" style="display: none;">
                    <div class="section-header">
                        <h3><i class="fas fa-cogs"></i> System Settings</h3>
                    </div>

                    <!-- Settings Tabs -->
                    <div class="settings-tabs">
                        <div class="tab-buttons">
                            <button class="tab-btn active" data-tab="general">General</button>
                            <button class="tab-btn" data-tab="camp">Camp Settings</button>
                            <button class="tab-btn" data-tab="users">User Management</button>
                            <button class="tab-btn" data-tab="notifications">Notifications</button>
                        </div>

                        <!-- General Settings -->
                        <div class="tab-content active" id="generalTab">
                            <form id="generalSettingsForm">
                                <div class="form-group">
                                    <label class="form-label">Camp Name</label>
                                    <input type="text" class="form-control"
                                        value="Roktojoba Foundation Free Medical Camp">
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="form-label">Camp Date</label>
                                        <input type="date" class="form-control" value="2025-12-16">
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Start Time</label>
                                        <input type="time" class="form-control" value="08:00">
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">End Time</label>
                                        <input type="time" class="form-control" value="17:00">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Camp Location</label>
                                    <textarea class="form-control"
                                        rows="2">123 Medical Street, Dhaka, Bangladesh</textarea>
                                </div>

                                <div class="form-group">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save"></i> Save Settings
                                    </button>
                                </div>
                            </form>
                        </div>

                        <!-- Camp Settings -->
                        <div class="tab-content" id="campTab">
                            <form id="campSettingsForm">
                                <div class="form-group">
                                    <label class="form-label">Registration Start Date</label>
                                    <input type="date" class="form-control" value="2025-12-01">
                                    <small>When patient registration opens (15 days before camp)</small>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Max Patients Per Day</label>
                                    <input type="number" class="form-control" value="500" min="1" max="1000">
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Avg. Checkup Time (minutes)</label>
                                    <input type="number" class="form-control" value="15" min="5" max="60">
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Doctor Shift Duration (hours)</label>
                                    <input type="number" class="form-control" value="8" min="4" max="12">
                                </div>

                                <div class="form-group">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save"></i> Save Settings
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- JavaScript Files -->
    <script src="js/firebase-config.js"></script>
    <script src="js/auth-manager.js"></script> <!-- নতুন ফাইল -->
    <script src="js/main-fixed.js"></script>
    <script src="js/admin.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Initialize admin dashboard
            initAdminDashboard();

            // Add custom styles for admin dashboard
            const style = document.createElement('style');
            style.textContent = `
                .badge {
                    display: inline-block;
                    padding: 2px 8px;
                    border-radius: 10px;
                    background-color: var(--primary-color);
                    color: white;
                    font-size: 0.75rem;
                    margin-left: auto;
                }
                
                .section-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 30px;
                    padding-bottom: 15px;
                    border-bottom: 1px solid #eee;
                }
                
                .section-header h3 {
                    display: flex;
                    align-items: center;
                    margin: 0;
                }
                
                .section-header h3 i {
                    margin-right: 10px;
                    color: var(--primary-color);
                }
                
                .last-updated {
                    font-size: 0.9rem;
                    color: var(--gray-color);
                }
                
                .charts-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
                    gap: 30px;
                    margin-bottom: 30px;
                }
                
                .stats-cards-small {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                    gap: 20px;
                    margin-bottom: 30px;
                }
                
                .stat-card-small {
                    background-color: white;
                    border-radius: var(--border-radius);
                    padding: 20px;
                    display: flex;
                    align-items: center;
                    box-shadow: var(--box-shadow);
                }
                
                .stat-icon-small {
                    width: 50px;
                    height: 50px;
                    border-radius: 50%;
                    background-color: rgba(69, 123, 157, 0.1);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    margin-right: 15px;
                    color: var(--accent-color);
                    font-size: 1.2rem;
                }
                
                .stat-card-small h4 {
                    font-size: 1.5rem;
                    color: var(--secondary-color);
                    margin: 0 0 5px 0;
                }
                
                .stat-card-small p {
                    color: var(--gray-color);
                    font-size: 0.9rem;
                    margin: 0;
                }
                
                .filters-card {
                    background-color: white;
                    border-radius: var(--border-radius);
                    padding: 20px;
                    margin-bottom: 20px;
                    box-shadow: var(--box-shadow);
                }
                
                .filter-row {
                    display: flex;
                    gap: 15px;
                    align-items: flex-end;
                    flex-wrap: wrap;
                }
                
                .filter-group {
                    flex: 1;
                    min-width: 200px;
                }
                
                .filter-group label {
                    display: block;
                    margin-bottom: 5px;
                    font-weight: 500;
                    color: var(--dark-color);
                }
                
                .filter-group span {
                    margin: 0 10px;
                    color: var(--gray-color);
                }
                
                .table-footer {
                    padding: 20px 0 0;
                    border-top: 1px solid #eee;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                }
                
                .pagination {
                    display: flex;
                    align-items: center;
                    gap: 15px;
                }
                
                .page-info {
                    color: var(--gray-color);
                }
                
                .settings-tabs {
                    background-color: white;
                    border-radius: var(--border-radius);
                    overflow: hidden;
                    box-shadow: var(--box-shadow);
                }
                
                .tab-buttons {
                    display: flex;
                    background-color: #f8f9fa;
                    border-bottom: 1px solid #eee;
                }
                
                .tab-btn {
                    padding: 15px 25px;
                    background: none;
                    border: none;
                    border-bottom: 3px solid transparent;
                    cursor: pointer;
                    font-weight: 500;
                    color: var(--dark-color);
                    transition: var(--transition);
                }
                
                .tab-btn:hover {
                    background-color: rgba(0, 0, 0, 0.05);
                }
                
                .tab-btn.active {
                    border-bottom-color: var(--primary-color);
                    color: var(--primary-color);
                    background-color: white;
                }
                
                .tab-content {
                    padding: 30px;
                    display: none;
                }
                
                .tab-content.active {
                    display: block;
                }
                
                .report-preview {
                    background-color: white;
                    border-radius: var(--border-radius);
                    padding: 30px;
                }
                
                .report-header {
                    text-align: center;
                    margin-bottom: 30px;
                    padding-bottom: 20px;
                    border-bottom: 2px solid var(--primary-color);
                }
                
                .report-header h2 {
                    color: var(--secondary-color);
                    margin-bottom: 10px;
                }
                
                .report-header p {
                    color: var(--gray-color);
                    font-size: 1.2rem;
                }
                
                .report-stats {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                    gap: 20px;
                    margin-bottom: 30px;
                }
                
                .report-summary {
                    margin-top: 30px;
                    padding-top: 20px;
                    border-top: 1px solid #eee;
                }
                
                @media (max-width: 768px) {
                    .charts-grid {
                        grid-template-columns: 1fr;
                    }
                    
                    .filter-row {
                        flex-direction: column;
                    }
                    
                    .filter-group {
                        width: 100%;
                    }
                    
                    .tab-buttons {
                        flex-wrap: wrap;
                    }
                    
                    .tab-btn {
                        flex: 1;
                        min-width: 120px;
                        text-align: center;
                    }
                }
            `;
            document.head.appendChild(style);

            // Navigation functionality
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('.dashboard-section');

            navLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();

                    // Remove active class from all links
                    navLinks.forEach(l => l.classList.remove('active'));

                    // Add active class to clicked link
                    this.classList.add('active');

                    // Get target section id
                    const targetId = this.id.replace('Link', 'Section');

                    // Hide all sections
                    sections.forEach(section => {
                        section.style.display = 'none';
                    });

                    // Show target section
                    const targetSection = document.getElementById(targetId);
                    if (targetSection) {
                        targetSection.style.display = 'block';
                    }
                });
            });

            // Tab functionality for settings
            const tabBtns = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');

            tabBtns.forEach(btn => {
                btn.addEventListener('click', function () {
                    const tabId = this.getAttribute('data-tab');

                    // Remove active class from all buttons and contents
                    tabBtns.forEach(b => b.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));

                    // Add active class to clicked button
                    this.classList.add('active');

                    // Show corresponding content
                    const tabContent = document.getElementById(`${tabId}Tab`);
                    if (tabContent) {
                        tabContent.classList.add('active');
                    }
                });
            });

            // Update last updated time
            function updateLastUpdatedTime() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('en-US', {
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                document.getElementById('updateTime').textContent = timeString;
            }

            // Update time every second
            updateLastUpdatedTime();
            setInterval(updateLastUpdatedTime, 1000);

            // Refresh activity button
            const refreshBtn = document.getElementById('refreshActivity');
            if (refreshBtn) {
                refreshBtn.addEventListener('click', function () {
                    loadRecentActivity();
                    this.innerHTML = '<i class="fas fa-sync-alt fa-spin"></i> Refreshing...';
                    setTimeout(() => {
                        this.innerHTML = '<i class="fas fa-sync-alt"></i> Refresh';
                    }, 1000);
                });
            }

            // Load recent activity
            async function loadRecentActivity() {
                try {
                    // This would load from Firebase in real implementation
                    const activities = [
                        {
                            time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                            activity: 'New patient registered',
                            user: 'System',
                            details: 'Registration ID: RJF123456'
                        },
                        {
                            time: new Date(Date.now() - 300000).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                            activity: 'Doctor assignment',
                            user: 'Admin User',
                            details: 'Dr. Smith assigned to patient RJF123456'
                        },
                        {
                            time: new Date(Date.now() - 600000).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                            activity: 'Checkup completed',
                            user: 'Dr. Johnson',
                            details: 'Patient RJF123457 checkup completed'
                        },
                        {
                            time: new Date(Date.now() - 900000).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                            activity: 'Volunteer checked in',
                            user: 'System',
                            details: 'John Doe checked in at Registration Desk'
                        },
                        {
                            time: new Date(Date.now() - 1200000).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                            activity: 'Report generated',
                            user: 'Admin User',
                            details: 'Daily summary report generated'
                        }
                    ];

                    const tbody = document.getElementById('activityTableBody');
                    tbody.innerHTML = '';

                    activities.forEach(activity => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${activity.time}</td>
                            <td>${activity.activity}</td>
                            <td>${activity.user}</td>
                            <td>${activity.details}</td>
                        `;
                        tbody.appendChild(row);
                    });

                } catch (error) {
                    console.error('Error loading activities:', error);
                }
            }

            // Initial load
            loadRecentActivity();

            // Update badges
            function updateBadges() {
                // This would be updated from Firebase in real implementation
                document.getElementById('patientBadge').textContent = '125';
                document.getElementById('doctorBadge').textContent = '12';
                document.getElementById('volunteerBadge').textContent = '35';
            }

            updateBadges();

            // Form submissions
            const forms = document.querySelectorAll('form');
            forms.forEach(form => {
                form.addEventListener('submit', function (e) {
                    e.preventDefault();
                    showAlert('Settings saved successfully!', 'success');
                });
            });

            // Export button
            const exportBtn = document.getElementById('exportPatientsBtn');
            if (exportBtn) {
                exportBtn.addEventListener('click', function () {
                    showAlert('Exporting patient data...', 'success');
                    // In real implementation, this would generate a CSV or PDF
                });
            }

            // Generate report button
            const generateReportBtn = document.getElementById('generateReport');
            if (generateReportBtn) {
                generateReportBtn.addEventListener('click', function () {
                    showAlert('Generating report... This might take a moment.', 'success');
                    // In real implementation, this would generate a detailed report
                });
            }
        });

        function initAdminDashboard() {
            // This function initializes the admin dashboard
            console.log('Admin dashboard initialized');
        }
    </script>
</body>

</html>